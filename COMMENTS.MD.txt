# COMMENTS.md

Este projeto implementa uma aplica√ß√£o full stack de gerenciamento de matr√≠culas de alunos utilizando:

- **Frontend**: Vue 3 + TypeScript + Vuetify 3 + Vite
- **Backend**: ASP.NET Core 8 com Entity Framework Core
- **Banco de dados**: PostgreSQL (pode ser substitu√≠do por MySQL ou banco InMemory para testes locais)

---

## ‚öôÔ∏è Decis√µes de Arquitetura

### Frontend

- **Framework**: Utiliza Vue 3 com script setup (Composition API) para simplicidade e reuso de l√≥gica.
- **UI**: Vuetify 3 com auto import ativado (via `vite-plugin-vuetify`).
- **Roteamento**: Vue Router com rotas nomeadas (`students`, `students/new`, `students/edit`).
- **Estado global**: Pinia com tipagem expl√≠cita, incluindo uso de `stubActions` para facilitar testes.
- **Comunica√ß√£o com a API**: `axios` centralizado no servi√ßo `studentService.ts`.
- **Componentiza√ß√£o**: Separado em `StudentList.vue`, `StudentForm.vue`, e l√≥gica extra√≠da em composables:
  - `useStudentList.ts` ‚Üí estado, a√ß√µes e intera√ß√£o com store/API
  - `useStudentForm.ts` ‚Üí formul√°rio, valida√ß√µes, salvar e feedback
- **Testes**: `Vitest` com cobertura de comportamento e renderiza√ß√£o, incluindo mocks de store e servi√ßos.

### Backend

- **Camadas**: `API`, `Application` e `Infrastructure`, com migra√ß√µes EF Core.
- **Modelos**: Agora utiliza DTOs (`CreateStudentRequest`, `UpdateStudentRequest`, `StudentResponse`) para abstrair a entidade `Student`.
- **Valida√ß√£o**: Realizada via `ModelState` com Data Annotations.
- **CORS**: Habilitado via pol√≠tica global para permitir origens como `http://localhost:5173`.
- **Migrations**: Usadas migrations padr√£o do EF Core para cria√ß√£o de banco.

---

## üì¶ Bibliotecas Utilizadas

### Frontend

- `vue`, `vue-router`, `vite`, `typescript`
- `vuetify`, `vite-plugin-vuetify`
- `pinia`, `@pinia/testing`
- `axios`
- `vitest`, `@vue/test-utils`

### Backend

- `Microsoft.AspNetCore.Mvc`
- `Microsoft.EntityFrameworkCore`
- `Microsoft.EntityFrameworkCore.Design`
- `Microsoft.EntityFrameworkCore.Tools`
- `coverlet.collector`
- `reportgenerator`

---

## üî¨ Testes e Cobertura

### Frontend:

- `vitest` com `@vue/test-utils` para montar componentes
- Testes validam renderiza√ß√£o, intera√ß√£o, exclus√£o e navega√ß√£o
- Router `push` mockado manualmente para testes com composables
- Comando para rodar testes:

```bash
npm run test
```

- Comando para cobertura:

```bash
npm run test -- --coverage
```

Gera arquivos `lcov` e `HTML` automaticamente.

### Backend:

- Estrutura pronta para uso com `xUnit` e `coverlet`
- Script PowerShell criado para automatizar cobertura:

```bash
.run-coverage.ps1
```

- Comando alternativo direto:

```bash
dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=lcov
reportgenerator -reports:coverage/lcov.info -targetdir:coverage-report -reporttypes:Html
```

Gera relat√≥rio lcov e HTML via `reportgenerator`.

---

## üîÅ Decis√µes de Arquitetura ‚Äì Refatora√ß√£o do StudentsController

Durante a refatora√ß√£o do StudentsController, priorizamos boas pr√°ticas de arquitetura e organiza√ß√£o de c√≥digo com foco em evolutividade, manuten√ß√£o e seguran√ßa de dados. Abaixo, destacamos as principais decis√µes tomadas:

### ‚úÖ 1. Implementa√ß√£o de DTOs (Data Transfer Objects)
- **Objetivo**: Separar a l√≥gica da API da entidade de dom√≠nio (`Student`).
- **Benef√≠cios**:
  - Prote√ß√£o contra exposi√ß√£o direta de entidades sens√≠veis.
  - Possibilidade de definir regras de valida√ß√£o espec√≠ficas por contexto (Create, Update, Response).
  - Flexibilidade para evoluir o backend sem impactar diretamente o frontend.

### ‚úÖ 2. Padroniza√ß√£o das Respostas da API
- **Antes**: A API retornava listas simples de entidades.
- **Agora**: Retorna um objeto com metadados (`items`, `totalItems`) e dados estruturados via `StudentResponse`.
- **Impacto**:
  - Facilita pagina√ß√£o no frontend.
  - Torna a API mais previs√≠vel, limpa e extens√≠vel.

### ‚úÖ 3. Prepara√ß√£o para Escalabilidade e Manutenibilidade
Mesmo com estrutura simples, a refatora√ß√£o:
- Isola responsabilidades.
- Permite futuras implementa√ß√µes de camadas como Services, Use Cases, Mediator, ou Clean Architecture.
- Abre caminho para testes unit√°rios eficazes em cada camada.

### ‚úÖ 4. C√≥digo mais leg√≠vel e coeso
- O controller se tornou mais enxuto.
- Opera√ß√µes organizadas com responsabilidades claras entre entrada (DTOs), l√≥gica e sa√≠da (Response).

### ‚úÖ 5. Evolu√ß√£o futura: gera√ß√£o de RA
- Atualmente, o RA √© gerado inline no controller com base em timestamp.
- Pode ser facilmente movido para um m√©todo `GenerateRAAsync()` ou `RAService`, permitindo:
  - Valida√ß√£o de unicidade.
  - Reuso em outros fluxos.
  - Substitui√ß√£o futura por outro padr√£o (ex: UUID, matr√≠cula integrada).

---

## üîÅ Decis√µes de Arquitetura ‚Äì Refatora√ß√£o do Frontend

Durante a refatora√ß√£o do frontend, focamos em organiza√ß√£o, legibilidade e separa√ß√£o de responsabilidades com base em boas pr√°ticas modernas do ecossistema Vue 3. Abaixo os principais pontos:

### ‚úÖ 1. Ado√ß√£o da Composition API com Composables
- **Objetivo**: Separar l√≥gica de estado, manipula√ß√£o e valida√ß√£o do template Vue.
- **Benef√≠cios**:
  - Melhor reuso e testabilidade.
  - Organiza√ß√£o clara de l√≥gica por dom√≠nio (ex: `useStudentList.ts`, `useStudentForm.ts`).
  - C√≥digo mais limpo e coeso.

### ‚úÖ 2. Componentes mais enxutos e focados
- **Antes**: Toda a l√≥gica de listagem, busca, formul√°rio e API ficava dentro dos `.vue`.
- **Agora**: Os componentes focam apenas na exibi√ß√£o e intera√ß√£o com os composables.
- **Impacto**:
  - Facilita manuten√ß√£o e onboarding.
  - Isola responsabilidades visuais de l√≥gicas de neg√≥cio.

### ‚úÖ 3. Testes mais robustos e contextualizados
- Atualizados para cobrir o novo fluxo de estado via composables.
- Mock do router e do servi√ßo mantidos para simular navega√ß√£o e requisi√ß√µes.
- Cobertura com `vitest --coverage` validando todos os fluxos principais.

### ‚úÖ 4. Ponto de melhoria futura
- Com a separa√ß√£o da l√≥gica, a aplica√ß√£o est√° pronta para evoluir com mais composables reutiliz√°veis (ex: toasts, valida√ß√µes globais, controle de di√°logos).
- Pr√≥ximos passos podem incluir abstra√ß√£o para hooks de CRUD gen√©ricos ou store modular.

---

## üöÄ Melhorias Futuras (com tempo adicional)

- [ ] Adicionar tratamento global de erros com middleware
- [ ] Melhorar design e responsividade do formul√°rio
- [ ] Substituir m√°scaras com lib dedicada

---

## ‚ùå Requisitos obrigat√≥rios n√£o entregues

Todos os requisitos obrigat√≥rios foram entregues com sucesso ‚úÖ

---

## üöÄ Resultado Final

A aplica√ß√£o entrega um CRUD completo de alunos com foco em boas pr√°ticas de arquitetura, separa√ß√£o de responsabilidades, integra√ß√£o funcional entre front e back e UX fluida com Vuetify. O c√≥digo segue padr√µes modernos de Vue 3 com Composition API e est√° preparado para manuten√ß√£o, testes e evolu√ß√£o.
